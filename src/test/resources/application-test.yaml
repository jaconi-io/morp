# Routing config
spring:
  cloud:
    gateway:
      routes:
        - id: mockserver
          uri: http://localhost:${mockServerPort}
          predicates:
            - Path=/upstream/**

morp:
  default-oauth2-client-registration: keycloak
  # Tenant identification
  tenant-extractors:
    - host-pattern:
        pattern: (\w+)-(dev|stg).example.com
        capture-group: 1
    - host-pattern:
        pattern: ([a-z]+).localtest.me
        capture-group: 1
    - host-mapping:
        special.example.com: foobar
        another-special.example.com: foobaz
    - path-pattern:
        pattern: /([a-z]+)/tenant/([a-z]+)
        capture-group: 2
    - header:
        name: X-Tenant-ID

  tenant:
    tenant1:
      # Configure tenant-specific credentials here.
      registration:
        client-id: morp
        client-secret: secret

  oauth2-client:
    registration:
      keycloak:
        client-id: morp
        client-secret: secret
        scope:
          - openid
          - profile
          - email
    provider:
      keycloak:
        issuer-uri: http://${keycloak.host:localhost}:9000/auth/realms/{tenant}
